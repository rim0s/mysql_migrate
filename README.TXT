

       ██████  ▄▄▄       ██▓ ███▄    █ ▄▄▄█████▓
     ▒██    ▒ ▒████▄    ▓██▒ ██ ▀█   █ ▓  ██▒ ▓▒
     ░ ▓██▄   ▒██  ▀█▄  ▒██▒▓██  ▀█ ██▒▒ ▓██░ ▒░
      ▒   ██▒░██▄▄▄▄██ ░██░▓██▒  ▐▌██▒░ ▓██▓ ░ 
    ▒██████▒▒ ▓█   ▓██▒░██░▒██░   ▓██░  ▒██▒ ░ 
     ▒ ▒▓▒ ▒ ░ ▒▒   ▓▒█░░▓  ░ ▒░   ▒ ▒   ▒ ░░   
     ░ ░▒  ░ ░  ▒   ▒▒ ░ ▒ ░░ ░░   ░ ▒░    ░    
     ░  ░  ░    ░   ▒    ▒ ░   ░   ░ ░   ░      
           ░        ░  ░ ░           ░                                                      
    
#############################################################
这不是一个成熟项目，也未经充分测试，请在充分阅读所有代码并理解后使用。
#############################################################
为什么会有这个脚本：
我的一个同事使用yum安装了发行版默认的mysql 8.x 服务，却没有自己初始化实例
并配置。随着/usr/lib/mysql文件夹越来越大，系统发出了最后通牒。再不进行干
预系统将含恨而去。我查看了一下系统存储情况，有个8T的空/data目录（一个raid5
基础、上的独立逻辑设备）。总共才70G的/已经大腹便便接近崩溃边缘。操作并不复杂，
也不繁琐。我也告知了原因和解决方法。但最近她又给我打电话因为另一个服务器上的
同样是mysql默认实例几乎占满磁盘空间的问题。操作虽然不繁琐，但是在客户的生产
环境执行这些操作着实让人毛骨悚然。于是借助 DeepSeek AI 我索要了一了个脚本，
把我关注并希望解决的大部分问题都通过代码执行。但是总而言之，原因就是: 我懒。
所以亲爱的路人，这些代码都是AI写的，虽然我也“做了点手脚”，但可以忽略不计。

我仅仅在 UOS Server 20 1070A x86-64 下进行了简单的单实例测试，且该实例
是默认安装并初始化的实例。测试环境 Selinux 是关闭状态，所以Selinux那段是
没经过验证的“想当然”。

mysql_migrate.sh，和RES中主要代码都是DeepSeek AI完成的。且功能完整。
detect_mysql_instances函数在多实例场景下发现存储的目录不准确，所以我
使用VScode 的 Copilit pro进行了完善，在测试已经符合后想要合并，但发现
Copilit 对于超过大概120行的文件时候总是试图通过编写命令序列或使用命令来
代为分析和处理，导致连完整的函数结构都被破坏，括号闭合都无法做到。于是后来
手动合并后又使用DeepSeek进行了完善。后来又添加了一些增加可靠性的小功能。

mysql_attach_instance.sh 是 Copilit pro 完成的，更加不完善，尤其是
systemd服务的配置文件建立的那部分。不过对于需求的完成情况来说，是过关了。
在检查代码并修正问题的过程，我要求Copilit使用RES中DeepSeek已经编写的
函数和功能。
#############################################################
刚才上传前在github上进行了一些搜索,发现有很多制作精良考虑周到的mysql实例
的文件迁移/移动的工具项目。我需要向他们学习，不过迫于生计我得将这件事推移了。
如果你想要解决问题，或许他们的好项目是你值得拥有的更好的选择。我之所以上传，
是因为我将无限期推迟或告别linux上那些有趣的事情了，希望在我走之前能把我关
注并付出过我思考的东西留下来，以备将来有幸我能再次回来继续完善它。如果它能
开花结果，当然我并没有这样的期待，我要提前感谢在我不在的时候，继续耕耘灌溉
的人。
#############################################################
# 使用流程
#############################################################
首次使用前：
# 1. 进入 RES 目录
cd RES

# 2. 运行部署脚本生成哈希文件
./deploy_validation_files.sh

# 3. 返回上级目录
cd ..

# 4. 运行主脚本
chmod +x mysql_migrate.sh
sudo ./mysql_migrate.sh yes
#############################################################
日常使用：
# 直接运行主脚本，它会自动加载验证系统
sudo ./mysql_migrate_V1.4.sh yes
#############################################################
验证文件完整性：
# 手动验证
cd RES
sha256sum -c mysql_validation_queries.sha256
#############################################################
关键注意事项 
权限：主脚本和验证脚本都需要执行权限
路径：保持目录结构不变
哈希安全：.sha256 文件用于验证查询文件是否被修改
兼容性：主脚本会检查所有必需文件是否存在
#############################################################
